constructor {
  /// Initialize the LINE token with metadata
  New : (name: str, symbol: str, decimals: u8);
};

service Line {
  /// Add a minter (only admin)
  AddMinter : (minter: actor_id) -> null;
  /// Mint tokens to an account (only minters)
  Mint : (to: actor_id, value: u256) -> bool;
  /// Pause withdrawals (admin only, emergency stop)
  PauseWithdrawals : () -> null;
  /// Remove a minter (only admin)
  RemoveMinter : (minter: actor_id) -> null;
  /// Set backend signer public key (admin only)
  SetBackendSigner : (signer_pubkey: [u8, 32]) -> null;
  /// Set maximum withdrawal per transaction (admin only)
  SetMaxWithdrawal : (max_amount: opt u256) -> null;
  /// Transfer tokens to another account
  Transfer : (to: actor_id, value: u256) -> bool;
  /// Unpause withdrawals (admin only)
  UnpauseWithdrawals : () -> null;
  /// Withdraw tokens with backend authorization (user pays gas)
  /// 
  /// # Arguments
  /// * `amount` - Amount of LINE tokens to withdraw (with decimals)
  /// * `withdrawal_id` - Unique 32-byte ID for this withdrawal (prevents replay)
  /// * `expiry` - Timestamp (ms) after which this withdrawal is invalid
  /// * `signature` - 64-byte sr25519 signature from backend
  Withdraw : (amount: u256, withdrawal_id: [u8, 32], expiry: u64, signature: vec u8) -> bool;
  /// Get all admins
  query Admins : () -> vec actor_id;
  /// Get backend signer public key
  query BackendSigner : () -> opt [u8, 32];
  /// Get the balance of an account
  query BalanceOf : (account: actor_id) -> u256;
  /// Get token decimals
  query Decimals : () -> u8;
  /// Check if an account is a minter
  query IsMinter : (account: actor_id) -> bool;
  /// Check if a withdrawal_id has been used
  query IsWithdrawalUsed : (withdrawal_id: [u8, 32]) -> bool;
  /// Get maximum withdrawal per transaction
  query MaxWithdrawal : () -> opt u256;
  /// Get all minters
  query Minters : () -> vec actor_id;
  /// Get token name
  query Name : () -> str;
  /// Get token symbol
  query Symbol : () -> str;
  /// Get total supply
  query TotalSupply : () -> u256;
  /// Check if withdrawals are paused
  query WithdrawalsPaused : () -> bool;

  events {
    /// Tokens transferred
    Transfer: struct {
      from: actor_id,
      to: actor_id,
      value: u256,
    };
    /// Tokens minted
    Minted: struct {
      to: actor_id,
      value: u256,
    };
    /// Minter role granted
    MinterAdded: struct {
      minter: actor_id
    };
    /// Minter role revoked
    MinterRemoved: struct {
      minter: actor_id
    };
    /// Tokens withdrawn via backend authorization
    WithdrawalExecuted: struct {
      to: actor_id,
      amount: u256,
      withdrawal_id: [u8, 32],
    };
    /// Backend signer public key updated
    BackendSignerUpdated: struct {
      signer_pubkey: [u8, 32]
    };
    /// Withdrawals paused
    WithdrawalsPaused;
    /// Withdrawals unpaused
    WithdrawalsUnpaused;
  }
};

